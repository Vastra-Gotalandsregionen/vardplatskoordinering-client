<vpk-title-row heading="{{management?.name}}{{management ? ', ' : ''}} {{dayName ? dayName + ' ' : ''}}{{date}}">
  <vpk-button-row align="right">

    <vpk-button-fab (click)="openDegreeOfImpactDialog()" icon="chart-line" color="" tooltip="Grad of påverkan"></vpk-button-fab>

    <vpk-button-fab (click)="picker.open()" icon="calendar-day" color="" tooltip="Byt datum"></vpk-button-fab>
  </vpk-button-row>
</vpk-title-row>


<div>
  <input  (dateChange)="dateSelected('change', $event)" [(ngModel)]="dateObject" type="hidden" [matDatepicker]="picker" placeholder="Välj datum">
  <mat-datepicker touchUi #picker></mat-datepicker>
</div>

<vpk-card title="Dagens beslut">
  <div *ngIf="(todaysDecisionDataSource.count | async) === 0">

    <vpk-alert message="Det finns inget beslut för dagen ännu."></vpk-alert>

    <vpk-button (click)="editNewDecision()" class="condensed" icon="plus" iconSize="2x" tooltip="Lägg till"></vpk-button>
  </div>

  <app-decision-table [dataSource]="todaysDecisionDataSource" (editDecision)="editDecisionByAkutenTrappaId($event)"></app-decision-table>
</vpk-card>

<vpk-card title="Dagens registreringar" icon="bed">

  <table mat-table [dataSource]="todaysRegistreringar">

    <ng-container matColumnDef="verksamhet">
      <th mat-header-cell *matHeaderCellDef>Verksamhet</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.verksamhet}}</td>
      <td mat-footer-cell *matFooterCellDef>Summa</td>
    </ng-container>

    <ng-container matColumnDef="dispVpl">
      <th mat-header-cell *matHeaderCellDef>Disp. vpl 06.00</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.dispVpl}}</td>
      <td mat-footer-cell *matFooterCellDef> {{sum(todaysRegistreringar, 'dispVpl')}} </td>
    </ng-container>

    <ng-container matColumnDef="inneliggande">
      <th mat-header-cell *matHeaderCellDef>Inneliggande</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.inneliggande}}</td>
      <td mat-footer-cell *matFooterCellDef> {{sum(todaysRegistreringar, 'inneliggande')}} </td>
    </ng-container>

    <ng-container matColumnDef="fysOtillaten">
      <th mat-header-cell *matHeaderCellDef>Beläggning</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.fysOtillaten}}</td>
      <td mat-footer-cell *matFooterCellDef> {{sum(todaysRegistreringar, 'fysOtillaten')}} </td>
    </ng-container>

    <ng-container matColumnDef="fysTillaten">
      <th mat-header-cell *matHeaderCellDef>Vpl med brister</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.fysTillaten}}</td>
      <td mat-footer-cell *matFooterCellDef> {{sum(todaysRegistreringar, 'fysTillaten')}} </td>
    </ng-container>

    <ng-container matColumnDef="prognosFore">
      <th mat-header-cell *matHeaderCellDef>Prognos lediga 16.00</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.prognosFore}}</td>
      <td mat-footer-cell *matFooterCellDef> {{sum(todaysRegistreringar, 'prognosFore')}} </td>
    </ng-container>

    <ng-container matColumnDef="maltalVardag">
      <th mat-header-cell *matHeaderCellDef>Måltal (vardag)</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.maltalVardag}}</td>
      <td mat-footer-cell *matFooterCellDef> {{sum(todaysRegistreringar, 'maltalVardag')}} </td>
    </ng-container>

    <ng-container matColumnDef="diffVardag">
      <th mat-header-cell *matHeaderCellDef>Prognos minus måltal</th>
      <td mat-cell *matCellDef="let registrera">{{registrera.diffVardag}}</td>
      <td mat-footer-cell *matFooterCellDef> {{sum(todaysRegistreringar, 'diffVardag')}} </td>
    </ng-container>

    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let registrera">
          <vpk-button *ngIf="!registrera.dispVpl" (click)="editRegistrera(registrera)" class="condensed" icon="plus" tooltip="Lägg till"></vpk-button>
          <vpk-button *ngIf="registrera.dispVpl" (click)="editRegistrera(registrera)" class="condensed" icon="pen" tooltip="Redigera"></vpk-button>
      </td>
      <td mat-footer-cell *matFooterCellDef></td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="todayDisplayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: todayDisplayedColumns;"></tr>
    <tr mat-footer-row *matFooterRowDef="todayDisplayedColumns" class="sum-row"></tr>

  </table>
</vpk-card>

<vpk-card title="Tidigare beslut">

  <app-decision-table [dataSource]="oldDecisionsDataSource" (editDecision)="editDecisionByAkutenTrappaId($event)"></app-decision-table>

</vpk-card>
